<html>
<head>
<link href="ihpsc.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

  <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$','$']]}
  });
  MathJax.Hub.Config({
    TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
  </script>

  <link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/default.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
</head>

<script type="application/javascript">
  // First we declare some metadata, primarily to describe
  // the container environment.
  var ccrsApiNamespace = "org.xsede.jobrunner.model.ModelApi";
  var mpiExampleMetaJson = {
    // CHANGE: for now, leave the appended string as .SysJobMetaData;
    //         other options will be supported in the future
    "$type": ccrsApiNamespace + ".SysJobMetaData",
    // CHANGE: shell to use implicitly when running commands in the container
    "shell": ["bash"],
    // CHANGE: should currently be one of: .NixOS, .Singularity
    "containerType": {
      "$type":  ccrsApiNamespace + ".NixOS"
    },
    // CHANGE: Specify for NixOS for all jobs, or for Singularity when resuming existing jobs
    "containerId": ["vicOpenMPI"],
    // CHANGE: Specify the singularity image name
    "image": [],
    // Directories on the host to mount in the container, if any:
    "binds": [],
    // Only for singularity:
    "overlay": [],
    // CHANGE: should be filled in dynamically to contain the (student) user,
    //         but this is a demo, so we use a static user name:
    "user": "test0",
    "address": [],
    "hostname": [],
    "url": window.location.href
  };
  var mpiExampleMeta = CCRS.sysJobMetaData(mpiExampleMetaJson);
</script>

<div class="container">
  <div class="row">
    <div class="col-12">
      <div class="pagehead">
        <h1>Plotting with GNUplot</h1>
        <h5>Experimental html version of downloadable textbook, see https://www.tacc.utexas.edu/~eijkhout/istc/istc.html</h5>
      </div>
    </div>
  </div>
  <div>

\[
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%
%%%% This text file is part of the source of 
%%%% `Introduction to High-Performance Scientific Computing'
%%%% by Victor Eijkhout, copyright 2012-2020
%%%%
%%%% mathjax.tex : macros to facility mathjax use in html version
%%%%
%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand\inv{^{-1}}\newcommand\invt{^{-t}}
\newcommand\bbP{\mathbb{P}}
\newcommand\bbR{\mathbb{R}}
\newcommand\defined{
  \mathrel{\lower 5pt \hbox{${\equiv\atop\mathrm{\scriptstyle D}}$}}}
\newcommand\macro[1]{$\langle$#1$\rangle$}
\newcommand\dtdxx{\frac{\alpha\Delta t}{\Delta x^2}}
\]


28.1 : <a href="gnuplot.html#Usagemodes">Usage modes</a><br>
28.2 : <a href="gnuplot.html#Plotting">Plotting</a><br>
28.2.1 : <a href="gnuplot.html#Plottingcurves">Plotting curves</a><br>
28.2.2 : <a href="gnuplot.html#Plottingdatapoints">Plotting data points</a><br>
28.2.3 : <a href="gnuplot.html#Customization">Customization</a><br>
28.3 : <a href="gnuplot.html#Workflow">Workflow</a><br>
<a href="index.html">Back to Table of Contents</a>
<h1>28 Plotting with GNUplot</h1>
<!-- TranslatingLineGenerator file ['file'] -->
</p>

<p name="switchToTextMode">
The 
<i>gnuplot</i>
<!-- index -->
 utility is a
simple program for plotting sets of points or curves. This very short
tutorial will show you some of the basics. For more commands and
options, see the manual

<a href=http://www.gnuplot.info/docs/gnuplot.html>http://www.gnuplot.info/docs/gnuplot.html</a>
.
</p>

<h2><a id="Usagemodes">28.1</a> Usage modes</h2>
<p name=crumbs>
crumb trail:  > <a href="gnuplot.html">gnuplot</a> > <a href="gnuplot.html#Usagemodes">Usage modes</a>
</p>
<p name="switchToTextMode">

The two modes for running 
<tt>gnuplot</tt>
 are 
<i>interactive</i>
 and
<i>from file</i>
command line, type commands, and watch output appear; you terminate an
interactive session with 
<tt>quit</tt>
.  If you want to save the results of
an interactive session, do 
<tt>save "name.plt"</tt>
. This file can be
edited, and loaded with 
<tt>load "name.plt"</tt>
.
</p>

<p name="switchToTextMode">
Plotting non-interactively, you call 
<tt>gnuplot <your file></tt>
.
</p>

<p name="switchToTextMode">
The output of 
<tt>gnuplot</tt>
 can be a picture on your screen, or drawing
instructions in a file. Where the output goes depends on the setting
of the 
<i>terminal</i>
. By default, 
<tt>gnuplot</tt>
 will try to draw a
picture. This is equivalent to declaring
<!-- environment: verbatim start embedded generator -->
</p>
set terminal x11
</pre>
</verbatim>
<!-- environment: verbatim end embedded generator -->
<p name="switchToTextMode">
or 
<tt>aqua</tt>
, 
<tt>windows</tt>
, or any choice of graphics hardware.
</p>

<p name="switchToTextMode">
For output to file, declare
<!-- environment: verbatim start embedded generator -->
</p>
set terminal pdf
</pre>
</verbatim>
<!-- environment: verbatim end embedded generator -->
<p name="switchToTextMode">
or 
<tt>fig</tt>
, 
<tt>latex</tt>
, 
<tt>pbm</tt>
, et cetera. Note that this will only
cause the pdf commands to be written to your screen: you need to
direct them to file with
<!-- environment: verbatim start embedded generator -->
</p>
  set output "myplot.pdf"
</pre>
</verbatim>
<!-- environment: verbatim end embedded generator -->
<p name="switchToTextMode">
or capture them with
<!-- environment: verbatim start embedded generator -->
</p>
  gnuplot my.plt &gt; myplot.pdf
</pre>
</verbatim>
<!-- environment: verbatim end embedded generator -->
<p name="switchToTextMode">

<h2><a id="Plotting">28.2</a> Plotting</h2>
<p name=crumbs>
crumb trail:  > <a href="gnuplot.html">gnuplot</a> > <a href="gnuplot.html#Plotting">Plotting</a>
</p>
</p>

<p name="switchToTextMode">
The basic plot commands are 
<tt>plot</tt>
 for 2D, and 
<tt>splot</tt>
 (`surface
plot') for 3D plotting.
</p>

<h3><a id="Plottingcurves">28.2.1</a> Plotting curves</h3>
<p name=crumbs>
crumb trail:  > <a href="gnuplot.html">gnuplot</a> > <a href="gnuplot.html#Plotting">Plotting</a> > <a href="gnuplot.html#Plottingcurves">Plotting curves</a>
</p>
<p name="switchToTextMode">

By specifying
<!-- environment: verbatim start embedded generator -->
</p>
plot x**2
</pre>
</verbatim>
<!-- environment: verbatim end embedded generator -->
<p name="switchToTextMode">
you get a plot of $f(x)=x^2$; 
<tt>gnuplot</tt>
 will decide on the range
for&nbsp;$x$.
With
<!-- environment: verbatim start embedded generator -->
</p>
set xrange [0:1]
plot 1-x title "down", x**2 title "up"
</pre>
</verbatim>
<!-- environment: verbatim end embedded generator -->
<p name="switchToTextMode">
you get two graphs in one plot, with the $x$&nbsp;range limited to&nbsp;$[0,1]$,
and the appropriate legends for the graphs. The variable&nbsp;
<tt>x</tt>
 is the
default for plotting functions.
</p>

<p name="switchToTextMode">
Plotting one function against another --&nbsp;or equivalently, plotting a
parametric curve&nbsp;-- goes like this:
<!-- environment: verbatim start embedded generator -->
</p>
set parametric
plot [t=0:1.57] cos(t),sin(t)
</pre>
</verbatim>
<!-- environment: verbatim end embedded generator -->
<p name="switchToTextMode">
which gives a quarter circle.
</p>

<p name="switchToTextMode">
To get more than one graph in a plot, use the command 
<tt>set multiplot</tt>
.
</p>

<h3><a id="Plottingdatapoints">28.2.2</a> Plotting data points</h3>
<p name=crumbs>
crumb trail:  > <a href="gnuplot.html">gnuplot</a> > <a href="gnuplot.html#Plotting">Plotting</a> > <a href="gnuplot.html#Plottingdatapoints">Plotting data points</a>
</p>
<p name="switchToTextMode">

It is also possible to plot curves based on data points. The basic
syntax is 
<tt>plot 'datafile'</tt>
, which takes two columns from the data
file and interprets them as $(x,y)$ coordinates. Since data files can often have
multiple columns of data, the common syntax is \n{plot 'datafile'
  using 3:6} for columns 3 and&nbsp;6. Further qualifiers like \n{with
  lines} indicate how points are to be connected.
</p>

<p name="switchToTextMode">
Similarly, 
<tt>splot "datafile3d.dat" 2:5:7</tt>
 will interpret three
columns as specifying $(x,y,z)$ coordinates for a 3D plot.
</p>

<p name="switchToTextMode">
If a data file is to be interpreted as level or height values on a
rectangular grid, do 
<tt>splot "matrix.dat" matrix</tt>
 for data points;
connect them with
<!-- environment: verbatim start embedded generator -->
</p>
  split "matrix.dat" matrix with lines
</pre>
</verbatim>
<!-- environment: verbatim end embedded generator -->
<p name="switchToTextMode">

<h3><a id="Customization">28.2.3</a> Customization</h3>
<p name=crumbs>
crumb trail:  > <a href="gnuplot.html">gnuplot</a> > <a href="gnuplot.html#Plotting">Plotting</a> > <a href="gnuplot.html#Customization">Customization</a>
</p>
</p>

<p name="switchToTextMode">
Plots can be customized in many ways. Some of these customizations use
the 
<tt>set</tt>
 command. For instance,
<!-- environment: verbatim start embedded generator -->
</p>
  set xlabel "time"
  set ylabel "output"
  set title "Power curve"
</pre>
</verbatim>
<!-- environment: verbatim end embedded generator -->
<p name="switchToTextMode">
You can also change the default drawing style with
<!-- environment: verbatim start embedded generator -->
</p>
set style function dots
</pre>
</verbatim>
<!-- environment: verbatim end embedded generator -->
<p name="switchToTextMode">
(
<tt>dots</tt>
, 
<tt>lines</tt>
, 
<tt>dots</tt>
, 
<tt>points</tt>
, et cetera), or
change on a single plot with
<!-- environment: verbatim start embedded generator -->
</p>
plot f(x) with points
</pre>
</verbatim>
<!-- environment: verbatim end embedded generator -->
<p name="switchToTextMode">

<h2><a id="Workflow">28.3</a> Workflow</h2>
<p name=crumbs>
crumb trail:  > <a href="gnuplot.html">gnuplot</a> > <a href="gnuplot.html#Workflow">Workflow</a>
</p>
</p>

<p name="switchToTextMode">
Imagine that your code produces a dataset that you want to plot, and
you run your code for a number of inputs. It would be nice if the
plotting can be automated. Gnuplot itself does not have the facilities
for this, but with a little help from shell programming this is not
hard to do.
</p>

<p name="switchToTextMode">
Suppose you have data files
<!-- environment: verbatim start embedded generator -->
</p>
  data1.dat data2.dat data3.dat
</pre>
</verbatim>
<!-- environment: verbatim end embedded generator -->
<p name="switchToTextMode">
and you want to plot them with the same gnuplot commands. You could
make a file 
<tt>plot.template</tt>
:
<!-- environment: verbatim start embedded generator -->
</p>
set term pdf
set output "FILENAME.pdf"
plot "FILENAME.dat"
</pre>
</verbatim>
<!-- environment: verbatim end embedded generator -->
<p name="switchToTextMode">
The string 
<tt>FILENAME</tt>
 can be replaced by the actual file names
using, for instance 
<tt>sed</tt>
:
<!-- environment: verbatim start embedded generator -->
</p>
for d in data1 data2 data3 ; do
  cat plot.template | sed s/FILENAME/$d/ &gt; plot.cmd
  gnuplot plot.cmd
done
</pre>
</verbatim>
<!-- environment: verbatim end embedded generator -->
<p name="switchToTextMode">
Variations on this basic idea are many.
</p>

</div>
<a href="index.html">Back to Table of Contents</a>
